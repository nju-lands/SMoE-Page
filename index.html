<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="color-scheme" content="light" />
  <title>Enabling MoE on the Edge via Importance-Driven Expert Scheduling</title>
  <meta name="description" content="Importance-Driven Expert Scheduling for MoE LLM inference on memory-constrained edge GPUs (SMoE): substitution, caching, and CPU–GPU pipeline to reduce PCIe overhead and decoding latency." />

  <!-- Social -->
  <meta property="og:title" content="Enabling MoE on the Edge via Importance-Driven Expert Scheduling" />
  <meta property="og:description" content="Substitute low-importance activated experts with functionally similar cached experts to reduce offloading and decoding latency on edge hardware." />
  <!-- Optional: put a preview image here after you export figures -->
  <!-- <meta property="og:image" content="assets/fig1.png" /> -->

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Source+Serif+4:opsz,wght@8..60,400;8..60,600&family=Source+Code+Pro:wght@400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      /* Light theme (designed to match white-background figures) */
      --bg: #ffffff;
      --bg-2: #f6f7fb;
      --card: rgba(17,24,39,.035);
      --card-2: rgba(17,24,39,.055);
      --stroke: rgba(17,24,39,.10);
      --stroke-2: rgba(17,24,39,.14);
      --text: #111827;
      --muted: rgba(17,24,39,.72);
      --muted-2: rgba(17,24,39,.56);
      --shadow: 0 24px 60px rgba(17,24,39,.10);
      --shadow-2: 0 12px 28px rgba(17,24,39,.10);
      --accent: #6d5efc;
      --accent-2: #10b981;
      --accent-3: #3b82f6;
      --accent-warm: #f59e0b;
      --radius: 18px;
      --radius-sm: 14px;
      --max: 1100px;
      --serif: "Source Serif 4", ui-serif, Georgia, serif;
      --sans: "Inter", ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      --mono: "Source Code Pro", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
    }

    *{ box-sizing: border-box; }
    html,body{ height: 100%; }
    body{
      margin: 0;
      color: var(--text);
      font-family: var(--sans);
      background:
        radial-gradient(1100px 650px at 15% -10%, rgba(109,94,252,.14), transparent 60%),
        radial-gradient(900px 600px at 90% 0%, rgba(59,130,246,.10), transparent 55%),
        radial-gradient(900px 600px at 75% 110%, rgba(16,185,129,.09), transparent 60%),
        linear-gradient(180deg, var(--bg), var(--bg-2));
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
      text-rendering: optimizeLegibility;
    }

    a{ color: inherit; text-decoration: none; }
    a:hover{ text-decoration: none; }

    .container{
      max-width: var(--max);
      margin: 0 auto;
      padding: 0 22px;
    }

    /* Top Nav */
    .topbar{
      position: sticky;
      top: 0;
      z-index: 50;
      backdrop-filter: blur(14px);
      background: rgba(255,255,255,.72);
      border-bottom: 1px solid var(--stroke);
    }
    .topbar-inner{
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      gap: 16px;
    }
    .brand{
      display: inline-flex;
      align-items: center;
      gap: 10px;
      min-width: 220px;
    }
    .mark{
      width: 34px;
      height: 34px;
      border-radius: 10px;
      background:
        radial-gradient(18px 18px at 28% 35%, rgba(255,255,255,.55), transparent 55%),
        linear-gradient(135deg, rgba(109,94,252,1), rgba(59,130,246,1));
      box-shadow: 0 14px 40px rgba(124,92,255,.25);
      border: 1px solid rgba(17,24,39,.12);
    }
    .brand-title{
      display: flex;
      flex-direction: column;
      line-height: 1.1;
    }
    .brand-title strong{ font-size: 13px; letter-spacing: .02em; }
    .brand-title span{ font-size: 12px; color: var(--muted); }

    .nav{
      display: flex;
      align-items: center;
      gap: 14px;
      flex-wrap: wrap;
      justify-content: center;
    }
    .nav a{
      font-size: 13px;
      color: var(--muted);
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid transparent;
      transition: .18s ease;
    }
    .nav a:hover{
      color: var(--text);
      border-color: var(--stroke);
      background: var(--card);
    }
    .nav a.active{
      color: var(--text);
      background: rgba(109,94,252,.10);
      border-color: rgba(109,94,252,.28);
    }

    .cta{
      display: flex;
      gap: 10px;
      align-items: center;
      justify-content: flex-end;
      min-width: 220px;
    }
    .btn{
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 9px 14px;
      border-radius: 999px;
      border: 1px solid rgba(17,24,39,.12);
      background: rgba(255,255,255,.78);
      color: var(--text);
      font-size: 13px;
      font-weight: 600;
      letter-spacing: .01em;
      transition: .18s ease;
      box-shadow: 0 10px 24px rgba(0,0,0,.18);
    }
    .btn:hover{
      transform: translateY(-1px);
      border-color: rgba(17,24,39,.18);
      background: rgba(255,255,255,.92);
      box-shadow: var(--shadow-2);
    }
    .btn.primary{
      border-color: rgba(109,94,252,.55);
      background: linear-gradient(135deg, rgba(109,94,252,.95), rgba(59,130,246,.80));
      color: #ffffff;
      box-shadow: 0 16px 40px rgba(109,94,252,.18);
    }
    .btn.primary:hover{
      box-shadow: 0 18px 46px rgba(124,92,255,.26);
    }
    .btn svg{ width: 15px; height: 15px; opacity: .92; }

    /* Hero */
    .hero{
      padding: 70px 0 36px;
    }
    .hero-grid{
      display: grid;
      grid-template-columns: 1.1fr .9fr;
      gap: 26px;
      align-items: start;
    }
    .badge{
      display: inline-flex;
      align-items: center;
      gap: 10px;
      border: 1px solid var(--stroke);
      background: rgba(255,255,255,.70);
      padding: 8px 12px;
      border-radius: 999px;
      color: var(--muted);
      font-size: 13px;
    }
    .badge .dot{
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: var(--accent-2);
      box-shadow: 0 0 0 6px rgba(52,211,153,.12);
    }
    h1{
      font-size: clamp(34px, 4vw, 52px);
      line-height: 1.06;
      margin: 16px 0 16px;
      letter-spacing: -0.03em;
    }
    .subtitle{
      margin: 0 0 18px;
      color: var(--muted);
      font-size: 16px;
      max-width: 60ch;
    }
    .authors{
      color: var(--muted);
      font-size: 13px;
      line-height: 1.6;
      margin-top: 12px;
    }
    .authors strong{ color: var(--text); font-weight: 700; }
    .hero-card{
      border-radius: var(--radius);
      border: 1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(255,255,255,.92), rgba(255,255,255,.72));
      box-shadow: var(--shadow);
      overflow: hidden;
    }
    .hero-card .top{
      padding: 18px 18px 10px;
      border-bottom: 1px solid var(--stroke);
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 10px;
    }
    .hero-card .top strong{ font-size: 13px; letter-spacing: .02em; }
    .hero-card .top span{ font-size: 12px; color: var(--muted); }
    .metrics{
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      padding: 16px 18px 18px;
    }
    .metric{
      padding: 14px 14px;
      border-radius: var(--radius-sm);
      background: var(--card);
      border: 1px solid var(--stroke);
    }
    .metric .k{
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 8px;
    }
    .metric .v{
      font-size: 22px;
      font-weight: 800;
      letter-spacing: -0.02em;
    }
    .metric .v small{
      font-size: 13px;
      font-weight: 700;
      color: var(--muted);
      margin-left: 6px;
    }
    .metric .hint{
      margin-top: 6px;
      font-size: 12px;
      color: var(--muted-2);
    }
    /* Sections */
    section{ padding: 46px 0; }
    .section-head{
      display:flex;
      align-items:flex-end;
      justify-content: space-between;
      gap: 14px;
      margin-bottom: 18px;
    }
    .section-head h2{
      margin: 0;
      font-size: 22px;
      letter-spacing: -0.02em;
    }
    .section-head p{
      margin: 0;
      color: var(--muted);
      font-family: var(--serif);
      max-width: 70ch;
      font-size: 15px;
    }
    .divider{
      height: 1px;
      background: linear-gradient(90deg, rgba(17,24,39,.0), rgba(17,24,39,.14), rgba(17,24,39,.0));
      margin: 18px 0 0;
    }

    .panel{
      border-radius: var(--radius);
      border: 1px solid var(--stroke);
      background: rgba(255,255,255,.75);
      box-shadow: var(--shadow-2);
      padding: 18px;
    }

    .bullets{
      display: grid;
      gap: 10px;
    }
    .bullet{
      padding: 12px 12px;
      border-radius: 14px;
      background: var(--card);
      border: 1px solid var(--stroke);
    }
    .bullet strong{ display:block; font-size: 13px; letter-spacing: .02em; }
    .bullet span{ display:block; margin-top: 6px; color: var(--muted); font-size: 13px; }

    .grid-3{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 14px;
    }
    .card{
      padding: 16px;
      border-radius: var(--radius);
      border: 1px solid var(--stroke);
      background: rgba(255,255,255,.75);
      box-shadow: var(--shadow-2);
      position: relative;
      overflow: hidden;
    }
    .card::before{
      content:"";
      position:absolute;
      inset: -40% -30%;
      background:
        radial-gradient(220px 160px at 35% 30%, rgba(124,92,255,.14), transparent 60%),
        radial-gradient(240px 180px at 70% 55%, rgba(96,165,250,.11), transparent 60%),
        radial-gradient(260px 200px at 30% 75%, rgba(52,211,153,.10), transparent 60%);
      transform: rotate(8deg);
      pointer-events:none;
    }
    .card > *{ position: relative; }
    .card h3{
      margin: 0 0 8px;
      font-size: 15px;
      letter-spacing: -0.01em;
    }
    .card p{
      margin: 0;
      color: var(--muted);
      font-family: var(--serif);
      font-size: 14px;
    }
    .tag{
      display:inline-flex;
      align-items:center;
      gap: 8px;
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 10px;
    }
    .tag .pill{
      width: 26px;
      height: 26px;
      border-radius: 10px;
      border: 1px solid var(--stroke);
      background: rgba(255,255,255,.75);
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .tag svg{ width: 14px; height: 14px; opacity: .9; }

    /* Figures */
    .figure-grid{
      display: grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 14px;
    }
    figure{
      margin: 0;
      border-radius: var(--radius);
      border: 1px solid var(--stroke);
      background: rgba(255,255,255,.78);
      box-shadow: var(--shadow-2);
      overflow: hidden;
    }
    figure .media{
      width: 100%;
      aspect-ratio: 16 / 9;
      background:
        radial-gradient(700px 260px at 30% 30%, rgba(109,94,252,.12), transparent 60%),
        radial-gradient(600px 260px at 70% 50%, rgba(59,130,246,.10), transparent 60%),
        linear-gradient(180deg, rgba(17,24,39,.02), rgba(17,24,39,.01));
      display:flex;
      align-items:center;
      justify-content:center;
      position: relative;
      padding: 12px;
    }
    figure .media img{
      width: 100%;
      height: 100%;
      object-fit: contain;
      display: block;
      background: #ffffff;
      border-radius: 12px;
      border: 1px solid rgba(17,24,39,.10);
      box-shadow: 0 10px 22px rgba(17,24,39,.08);
    }
    figure .placeholder{
      position:absolute;
      inset: 0;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 18px;
      text-align:center;
      color: rgba(17,24,39,.72);
      font-size: 13px;
      font-weight: 600;
      letter-spacing: .02em;
    }
    figcaption{
      padding: 12px 14px 14px;
      border-top: 1px solid var(--stroke);
      color: var(--muted);
      font-size: 13px;
      font-family: var(--serif);
    }
    figcaption strong{ color: var(--text); font-family: var(--sans); font-size: 12px; letter-spacing: .02em; }
    figcaption span{ display:block; margin-top: 6px; }

    .span-7{ grid-column: span 7; }
    .span-5{ grid-column: span 5; }
    .span-6{ grid-column: span 6; }
    .span-12{ grid-column: span 12; }

    /* Split (text + figure) blocks for findings */
    .split{
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 18px;
      align-items: center;
      margin-top: 18px;
    }
    .split.reverse{
      grid-template-columns: 1fr 1fr;
    }
    .split.reverse .split-text{ order: 2; }
    .split.reverse figure{ order: 1; }
    .split-text{
      padding: 16px;
      border-radius: var(--radius);
      border: 1px solid var(--stroke);
      background: rgba(255,255,255,.70);
      box-shadow: var(--shadow-2);
    }
    .split-text h4{
      margin: 0 0 10px;
      font-size: 15px;
      letter-spacing: -0.01em;
    }
    .split-text p{
      margin: 0;
      color: var(--muted);
      font-family: var(--serif);
      font-size: 14px;
      line-height: 1.7;
    }
    .split figure .media{ min-height: 300px; }

    /* Citation */
    .bib{
      font-family: var(--mono);
      font-size: 13px;
      background: rgba(17,24,39,.03);
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      padding: 16px;
      overflow:auto;
      white-space: pre;
      color: rgba(17,24,39,.90);
    }
    .row{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 10px;
      margin: 0 0 10px;
    }
    .row strong{ font-size: 13px; letter-spacing: .02em; }

    footer{
      padding: 40px 0 60px;
      color: var(--muted-2);
      font-size: 12px;
    }
    .foot{
      display:flex;
      align-items:flex-start;
      justify-content: space-between;
      gap: 18px;
      flex-wrap: wrap;
      border-top: 1px solid var(--stroke);
      padding-top: 22px;
    }
    .foot strong{ color: var(--text); }

    @media (max-width: 980px){
      .hero-grid{ grid-template-columns: 1fr; }
      .cta{ display: none; }
      .brand{ min-width: unset; }
    }
    @media (max-width: 880px){
      .grid-3{ grid-template-columns: 1fr; }
      .span-7,.span-5,.span-6,.span-12{ grid-column: span 12; }
    }
    @media (max-width: 980px){
      .split{ grid-template-columns: 1fr; }
      .split.reverse .split-text{ order: 0; }
      .split.reverse figure{ order: 0; }
    }
  </style>
</head>
<body>

  <div class="topbar">
    <div class="container">
      <div class="topbar-inner">
        <a class="brand" href="#top" aria-label="Home">
          <div class="mark" aria-hidden="true"></div>
          <div class="brand-title">
            <strong>MoE-Edge · SMoE</strong>
            <span>Importance-Driven Expert Scheduling</span>
          </div>
        </a>

        <nav class="nav" aria-label="Sections">
          <a href="#ascend"><span data-i18n="nav.ascend">Ascend 910B</span></a>
          <a href="#motivation"><span data-i18n="nav.motivation">Motivation</span></a>
          <a href="#method"><span data-i18n="nav.method">Method</span></a>
          <a href="#results"><span data-i18n="nav.results">Results</span></a>
          <a href="#citation"><span data-i18n="nav.citation">Citation</span></a>
        </nav>

        <div class="cta">
          <a class="btn" href="https://arxiv.org/abs/2508.18983" target="_blank" rel="noreferrer">
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M7 7h10v10H7z" stroke="currentColor" stroke-width="1.7" opacity=".9"/>
              <path d="M9 5h10v10" stroke="currentColor" stroke-width="1.7" opacity=".9"/>
            </svg>
            <span>arXiv</span>
          </a>
          <a class="btn primary" href="https://arxiv.org/pdf/2508.18983" target="_blank" rel="noreferrer">
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M7 3h7l3 3v15a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1z" stroke="currentColor" stroke-width="1.7"/>
              <path d="M14 3v4h4" stroke="currentColor" stroke-width="1.7"/>
            </svg>
            <span data-i18n="cta.pdf">PDF</span>
          </a>
          <a class="btn" href="https://github.com/goingshr-debug/SMoE" target="_blank" rel="noreferrer">
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M9 19c-3 1-3-2-4-2" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
              <path d="M15 19v-2.2c0-.7.2-1.2.6-1.6 2 .2 4-.5 4-4.2 0-1-.4-1.9-1-2.6.1-.3.5-1.2-.1-2.6 0 0-.8-.3-2.6 1a8.9 8.9 0 0 0-4.8 0c-1.8-1.3-2.6-1-2.6-1-.6 1.4-.2 2.3-.1 2.6-.6.7-1 1.6-1 2.6 0 3.7 2 4.4 4 4.2.3.3.5.7.6 1.2" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M12 20c4 0 8-3 8-8a8 8 0 1 0-16 0c0 5 4 8 8 8z" stroke="currentColor" stroke-width="1.7" opacity=".35"/>
            </svg>
            <span data-i18n="cta.code">Code</span>
          </a>
          <button class="btn" id="langToggle" type="button" aria-label="Toggle language">
            中文
          </button>
        </div>
      </div>
    </div>
  </div>

  <main id="top">
    <div class="container">

      <section id="ascend" aria-label="Huawei Ascend 910B" style="padding-top: 18px; padding-bottom: 0;">
        <div class="panel" style="margin-top: 0; background: linear-gradient(135deg, rgba(255,255,255,.92), rgba(240,248,255,.96)); border-color: rgba(109,94,252,.20);">
          <div class="grid-3" style="grid-template-columns: 1.2fr .8fr; gap: 18px; align-items: center;">
            <div>
              <div style="display:inline-flex; align-items:center; gap:8px; margin-bottom:10px; color:#c00;">
                <svg viewBox="0 0 24 24" fill="currentColor" style="width:18px;height:18px;">
                  <path d="M12 2L2 7l10 5 10-5-10-5zm0 9l2.968 1.484L12 14l-2.968-1.516L12 11zm0 2.296l-5-2.5v5l5 2.5 5-2.5v-5l-5 2.5z"/>
                </svg>
                <strong style="font-size:13px; letter-spacing:.03em; text-transform:uppercase;" data-i18n="ascend.badge">Ascend Ready</strong>
              </div>
              <h2 style="margin: 0 0 10px; font-size: 22px; letter-spacing: -0.02em;" data-i18n="ascend.title">Huawei Ascend 910B Support</h2>
              <p style="margin: 0; color: var(--muted); font-family: var(--serif); line-height:1.7;" data-i18n="ascend.desc">
                SMoE can be deployed on Huawei Ascend platforms via <strong>CANN</strong>. The core idea remains unchanged: keep hot experts in device memory,
                maximize reuse (hits + soft hits), and overlap compute with asynchronous transfers to minimize end-to-end latency.
              </p>
              <div style="margin-top: 12px; display:flex; gap: 12px; flex-wrap: wrap;">
                <a class="btn primary" href="https://github.com/goingshr-debug/SMoE" target="_blank" rel="noreferrer" style="background:#c00; border-color:#c00; box-shadow: 0 10px 22px rgba(204,0,0,.18);">
                  <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                    <path d="M9 19c-3 1-3-2-4-2" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
                    <path d="M15 19v-2.2c0-.7.2-1.2.6-1.6 2 .2 4-.5 4-4.2 0-1-.4-1.9-1-2.6.1-.3.5-1.2-.1-2.6 0 0-.8-.3-2.6 1a8.9 8.9 0 0 0-4.8 0c-1.8-1.3-2.6-1-2.6-1-.6 1.4-.2 2.3-.1 2.6-.6.7-1 1.6-1 2.6 0 3.7 2 4.4 4 4.2.3.3.5.7.6 1.2" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M12 20c4 0 8-3 8-8a8 8 0 1 0-16 0c0 5 4 8 8 8z" stroke="currentColor" stroke-width="1.7" opacity=".35"/>
                  </svg>
                  <span data-i18n="ascend.btnCode">SMoE Code (GitHub)</span>
                </a>
                <a class="btn" href="#method">
                  <span data-i18n="ascend.btnMethod">View Method</span>
                </a>
              </div>
            </div>
            <div class="bullets">
              <div class="bullet">
                <strong data-i18n="ascend.b1.title">Ascend 910B (Da Vinci)</strong>
                <span data-i18n="ascend.b1.desc">High-throughput AI accelerator designed for large-scale training and inference.</span>
              </div>
              <div class="bullet">
                <strong data-i18n="ascend.b2.title">HBM capacity & bandwidth</strong>
                <span data-i18n="ascend.b2.desc">Large HBM enables a bigger expert cache residency and fewer transfers.</span>
              </div>
              <div class="bullet">
                <strong data-i18n="ascend.b3.title">CANN runtime</strong>
                <span data-i18n="ascend.b3.desc">Stream-based scheduling + async memcpy primitives to overlap compute and transfers.</span>
              </div>
            </div>
          </div>
        </div>
      </section>

      <header class="hero">
        <div class="hero-grid">
          <div>
            <div class="badge">
              <span class="dot" aria-hidden="true"></span>
              <span data-i18n="hero.badge">Edge MoE inference · Substitution + Scheduling · CPU–GPU Pipeline</span>
            </div>

            <h1 data-i18n="hero.title">Enabling MoE on the Edge<br/>via Importance-Driven Expert Scheduling</h1>

            <p class="subtitle" data-i18n="hero.subtitle">
              On memory-constrained edge GPUs, we adopt an <strong>importance-driven</strong> policy to prioritize critical experts and <strong>substitute</strong> low-importance activated experts
              with functionally similar experts already cached in GPU memory, reducing PCIe transfers and CPU computation to significantly improve decoding latency (TPOT).
            </p>

          </div>

          <aside class="hero-card" aria-label="Highlights">
            <div class="top">
              <div>
                <strong data-i18n="hero.keyClaimsTitle">Key claims</strong><br/>
                <span data-i18n="hero.keyClaimsSubtitle">high-level summary</span>
              </div>
              <span style="color: var(--muted); font-size: 12px;">SMoE</span>
            </div>
            <div class="metrics">
              <div class="metric">
                <div class="k" data-i18n="hero.metric1.k">Decoding latency</div>
                <div class="v">-48%<small>TPOT</small></div>
                <div class="hint" data-i18n="hero.metric1.hint">vs. SOTA baselines</div>
              </div>
              <div class="metric">
                <div class="k" data-i18n="hero.metric2.k">Cache hit rate</div>
                <div class="v">≥60%<small>experts</small></div>
                <div class="hint" data-i18n="hero.metric2.hint">with near-lossless accuracy</div>
              </div>
            </div>
          </aside>
        </div>
      </header>

      <section id="motivation" aria-label="Motivation">
        <div class="section-head">
          <div>
            <h2 data-i18n="motivation.title">Motivation</h2>
            <p data-i18n="motivation.subtitle">Why edge MoE is hard: PCIe transfer dominates the latency.</p>
          </div>
        </div>
        <div class="divider"></div>

        <div class="grid-3" style="margin-top: 16px; grid-template-columns: 1.2fr 0.8fr; align-items: center;">
          <div class="span-6" style="grid-column: span 1;">
            <h3 style="margin-top:0; font-size:18px;" data-i18n="motivation.h3">The "Memory Wall" Bottleneck</h3>
            <p style="color:var(--muted); font-size:15px; line-height:1.7;" data-i18n="motivation.p">
              On edge devices (e.g., NVIDIA A6000), fetching experts from CPU memory via PCIe is orders of magnitude slower than computing them on GPU.
              As shown in the figure, the <strong>PCIe transfer time (orange)</strong> often exceeds the actual <strong>GPU computation time (blue)</strong> by a large margin.
              To achieve real-time inference (low TPOT), optimizing compute is not enough—we must minimize these expensive transfers.
            </p>
          </div>
          <figure class="span-6" style="grid-column: span 1;">
            <div class="media">
              <img src="assets/fig-bottleneck.png" alt="Bottleneck Analysis" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';" />
              <div class="placeholder" style="display:none;" data-i18n="common.imgUnavailable">Image unavailable.</div>
            </div>
            <figcaption>
              <strong data-i18n="motivation.cap.title">The Bottleneck</strong>
              <span data-i18n="motivation.cap.desc">PCIe transfer vs. GPU compute time.</span>
            </figcaption>
          </figure>
        </div>
      </section>

      <section id="method" aria-label="Method">
        <div class="section-head">
          <div>
            <h2 data-i18n="method.title">Method</h2>
            <p data-i18n="method.subtitle">SMoE: Importance-Driven Scheduling with Substitution.</p>
          </div>
        </div>
        <div class="divider"></div>

        <div class="grid-3" style="margin-top: 16px;">
          <div class="card">
            <div class="tag">
              <span class="pill" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M4 7h16M4 12h10M4 17h16" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
                </svg>
              </span>
              <span data-i18n="method.card1.tag">1. Router</span>
            </div>
            <h3 data-i18n="method.card1.title">Expert-Cache Router</h3>
            <p data-i18n="method.card1.desc">Distinguish critical vs. non-critical experts based on gating scores. Prioritize VRAM for critical ones.</p>
          </div>
          <div class="card">
            <div class="tag">
              <span class="pill" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M12 21a9 9 0 1 0-9-9" stroke="currentColor" stroke-width="1.7" opacity=".9"/>
                </svg>
              </span>
              <span data-i18n="method.card2.tag">2. Strategy</span>
            </div>
            <h3 data-i18n="method.card2.title">Similarity-based Substitution</h3>
            <p data-i18n="method.card2.desc">If a non-critical expert is missing, don't fetch it. Substitute it with a functionally similar cached expert.</p>
          </div>
          <div class="card">
            <div class="tag">
              <span class="pill" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M7 7h10v10H7z" stroke="currentColor" stroke-width="1.7"/>
                  <path d="M3 12h2M19 12h2" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
                </svg>
              </span>
              <span data-i18n="method.card3.tag">3. System</span>
            </div>
            <h3 data-i18n="method.card3.title">CPU–GPU Pipeline</h3>
            <p data-i18n="method.card3.desc">Overlap the computation of cached experts with the prefetching of missing critical experts.</p>
          </div>
        </div>

        <div class="figure-grid" style="margin-top: 24px;">
          <!-- Side-by-side layout with fixed height for alignment -->
          <figure class="span-7">
            <div class="media" style="height: 380px;">
              <img src="assets/fig1.png" alt="Framework Overview" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';" />
              <div class="placeholder" style="display:none;" data-i18n="common.imgUnavailable">Image unavailable.</div>
            </div>
            <figcaption>
              <strong data-i18n="method.fig1.title">Framework Overview</strong>
              <span data-i18n="method.fig1.desc">Substitution-aware scheduler: replace low-score experts, prefetch top-score ones.</span>
            </figcaption>
          </figure>
          
          <figure class="span-5">
            <div class="media" style="height: 380px;">
              <img src="assets/fig-pipeline.png" alt="Execution Pipeline" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';" />
              <div class="placeholder" style="display:none;" data-i18n="common.imgUnavailable">Image unavailable.</div>
            </div>
            <figcaption>
              <strong data-i18n="method.pipeline.title">Execution Pipeline</strong>
              <span data-i18n="method.pipeline.desc">Overlapping GPU compute, CPU offloading, and PCIe transfers.</span>
            </figcaption>
          </figure>
        </div>
      </section>

      <section id="results" aria-label="Results">
        <div class="section-head">
          <div>
            <h2 data-i18n="results.title">Key Findings</h2>
            <p data-i18n="results.subtitle">How far can we reduce latency without hurting accuracy?</p>
          </div>
        </div>
        <div class="divider"></div>

        <div style="margin-top: 24px;">
          <h3 style="font-size: 18px; margin-bottom: 12px; color: var(--text);" data-i18n="results.q1.title">01. Does substitution significantly reduce decoding latency?</h3>
          <p style="margin-bottom: 16px; color: var(--muted); max-width: 80ch;" data-i18n="results.q1.p">
            <strong>Yes, by nearly half.</strong> By substituting non-critical experts instead of loading them, SMoE avoids a massive amount of PCIe traffic.
            Compared to state-of-the-art offloading baselines, our method achieves up to a <strong>48% reduction in TPOT</strong> (Time Per Output Token).
          </p>
          <div class="figure-grid">
            <figure class="span-12">
              <div class="media" style="min-height: 400px;">
                <img src="assets/fig-latency.png" alt="Main Result" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';" />
                <div class="placeholder" style="display:none;" data-i18n="common.imgUnavailable">Image unavailable.</div>
              </div>
              <figcaption>
                <strong data-i18n="results.q1.cap.title">Decoding Latency (TPOT)</strong>
                <span data-i18n="results.q1.cap.desc">Comparison across 5 workloads showing consistent speedups over baselines like MoE-Infinity and ProMoE.</span>
              </figcaption>
            </figure>
          </div>
        </div>

        <div style="margin-top: 50px;">
          <h3 style="font-size: 18px; margin-bottom: 12px; color: var(--text);" data-i18n="results.q2.title">02. Why does the speedup happen?</h3>
          <p style="margin-bottom: 24px; color: var(--muted); max-width: 80ch;" data-i18n="results.q2.p">
            <strong>Because PCIe overhead is cut drastically.</strong> As shown below, TPOT is strongly correlated with PCIe time.
            By maintaining a high <strong>cache hit rate (>60%)</strong> through substitution, we ensure that most activated experts are already on the GPU.
          </p>

          <!-- Alternating text + figure blocks (fills space and improves readability) -->
          <div class="split">
            <div class="split-text">
              <h4 data-i18n="results.q2.s1.h">PCIe time directly translates to TPOT</h4>
              <p data-i18n="results.q2.s1.p">
                In edge settings, expert offloading is dominated by PCIe transfer. This plot shows a strong correlation between PCIe time and TPOT,
                explaining why reducing transfers yields immediate decoding speedups.
              </p>
            </div>
            <figure>
              <div class="media">
                <img src="assets/fig-pcie-vs-tpot.png" alt="PCIe vs TPOT" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';" />
                <div class="placeholder" style="display:none;" data-i18n="common.imgUnavailable">Image unavailable.</div>
              </div>
              <figcaption>
                <strong data-i18n="results.q2.s1.cap.title">PCIe vs. TPOT</strong>
                <span data-i18n="results.q2.s1.cap.desc">Lower PCIe time consistently maps to lower TPOT.</span>
              </figcaption>
            </figure>
          </div>

          <div class="split reverse">
            <div class="split-text">
              <h4 data-i18n="results.q2.s2.h">High cache hit rate keeps execution on GPU</h4>
              <p data-i18n="results.q2.s2.p">
                SMoE maximizes the reuse ratio of GPU-cached experts. With substitution, many low-importance activations become “soft hits”,
                so the GPU can execute most experts without waiting for CPU→GPU transfers.
              </p>
            </div>
            <figure>
              <div class="media">
                <img src="assets/fig-hit-rate.png" alt="Cache hit rate" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';" />
                <div class="placeholder" style="display:none;" data-i18n="common.imgUnavailable">Image unavailable.</div>
              </div>
              <figcaption>
                <strong data-i18n="results.q2.s2.cap.title">Cache Hit Rate</strong>
                <span data-i18n="results.q2.s2.cap.desc">Sustained high reuse ratio across settings.</span>
              </figcaption>
            </figure>
          </div>

          <div class="split">
            <div class="split-text">
              <h4 data-i18n="results.q2.s3.h">Substitution reduces the number of experts that must be loaded</h4>
              <p data-i18n="results.q2.s3.p">
                The key is selectivity: only a few activated experts are truly critical (high-score). Low-score activated experts can be substituted
                by functionally similar experts already in VRAM, so fewer experts need fetching and prefetching becomes lighter.
              </p>
            </div>
            <figure>
              <div class="media">
                <img src="assets/fig-components-load.png" alt="Reduced load" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';" />
                <div class="placeholder" style="display:none;" data-i18n="common.imgUnavailable">Image unavailable.</div>
              </div>
              <figcaption>
                <strong data-i18n="results.q2.s3.cap.title">Reduced Load</strong>
                <span data-i18n="results.q2.s3.cap.desc">Fewer experts need fetching from CPU memory.</span>
              </figcaption>
            </figure>
          </div>
        </div>

        <div style="margin-top: 50px;">
          <h3 style="font-size: 18px; margin-bottom: 12px; color: var(--text);" data-i18n="results.q3.title">03. Which component contributes the most?</h3>
          <p style="margin-bottom: 16px; color: var(--muted); max-width: 80ch;" data-i18n="results.q3.p">
            <strong>Substitution is the key driver.</strong> The ablation study below shows that while the pipeline and prefetching help,
            the substitution mechanism (orange bar segments) provides the most significant reduction in latency.
          </p>
          <div class="figure-grid" style="justify-content: center;">
            <figure class="span-8" style="grid-column: 3 / 11;">
              <div class="media" style="min-height: 350px;">
                <img src="assets/fig-ablation.png" alt="Ablation Study" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';" />
                <div class="placeholder" style="display:none;" data-i18n="common.imgUnavailable">Image unavailable.</div>
              </div>
              <figcaption>
                <strong data-i18n="results.q3.cap.title">Component Ablation</strong>
                <span data-i18n="results.q3.cap.desc">Breakdown of latency savings by component.</span>
              </figcaption>
            </figure>
          </div>
        </div>

        <div style="margin-top: 50px;">
          <h3 style="font-size: 18px; margin-bottom: 12px; color: var(--text);" data-i18n="results.q4.title">04. Is CPU compute a viable fallback at low batch?</h3>
          <p style="margin-bottom: 16px; color: var(--muted); max-width: 80ch;" data-i18n="results.q4.p">
            <strong>Usually not.</strong> In low-batch edge serving, CPU compute can be significantly slower than GPU execution, and the system often becomes
            dominated by memory movement and CPU-side compute stalls. This motivates keeping as much execution on GPU as possible.
          </p>
          <div class="split">
            <div class="split-text">
              <h4 data-i18n="results.q4.s1.h">GPU vs. CPU under low-batch serving</h4>
              <p data-i18n="results.q4.s1.p">
                This comparison highlights the gap between GPU (A6000) and CPU (8-core) at low batch. SMoE’s goal is to avoid CPU-side expert execution whenever possible
                by increasing GPU-resident “hits” (hard hits + soft hits).
              </p>
            </div>
            <figure>
              <div class="media">
                <img src="assets/fig-cpu-vs-gpu-lowbatch.png" alt="GPU vs CPU at low batch" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';" />
                <div class="placeholder" style="display:none;" data-i18n="common.imgUnavailable">Image unavailable.</div>
              </div>
              <figcaption>
                <strong data-i18n="results.q4.cap.title">GPU vs. CPU at Low Batch</strong>
                <span data-i18n="results.q4.cap.desc">CPU execution is often a poor fallback for interactive edge workloads.</span>
              </figcaption>
            </figure>
          </div>
        </div>

        <div style="margin-top: 50px;">
          <h3 style="font-size: 18px; margin-bottom: 12px; color: var(--text);" data-i18n="results.q5.title">05. Does SMoE help beyond decoding (prefill)?</h3>
          <p style="margin-bottom: 16px; color: var(--muted); max-width: 80ch;" data-i18n="results.q5.p">
            <strong>Yes.</strong> While TPOT is the core metric for interactive decoding, prefill time also matters for end-to-end latency.
            We observe consistent prefill-time improvements under the same memory and offloading constraints.
          </p>
          <div class="split reverse">
            <div class="split-text">
              <h4 data-i18n="results.q5.s1.h">Prefill time reduction</h4>
              <p data-i18n="results.q5.s1.p">
                Prefill is typically more parallel than decoding, but it still suffers from expert movement and cache misses when VRAM is constrained.
                SMoE reduces the loading pressure so prefill can finish faster on average.
              </p>
            </div>
            <figure>
              <div class="media">
                <img src="assets/fig-prefill-time.png" alt="Prefill time" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';" />
                <div class="placeholder" style="display:none;" data-i18n="common.imgUnavailable">Image unavailable.</div>
              </div>
              <figcaption>
                <strong data-i18n="results.q5.cap.title">Prefill Time</strong>
                <span data-i18n="results.q5.cap.desc">Average prefill time across baselines and SMoE.</span>
              </figcaption>
            </figure>
          </div>
        </div>

        <div style="margin-top: 50px;">
          <h3 style="font-size: 18px; margin-bottom: 12px; color: var(--text);" data-i18n="results.q6.title">06. Does prefetching compromise accuracy?</h3>
          <p style="margin-bottom: 16px; color: var(--muted); max-width: 80ch;" data-i18n="results.q6.p">
            <strong>It can be controlled.</strong> We evaluate the quality impact of prefetching policies. Combined with importance-driven selection and substitution,
            the system is designed to keep quality near-lossless while accelerating inference.
          </p>
          <div class="split">
            <div class="split-text">
              <h4 data-i18n="results.q6.s1.h">Quality under prefetching</h4>
              <p data-i18n="results.q6.s1.p">
                Prefetching reduces stalls but risks loading the “wrong” experts when routing changes. Measuring accuracy under prefetching helps validate that the scheduling policy
                stays aligned with the model’s true expert usage.
              </p>
            </div>
            <figure>
              <div class="media">
                <img src="assets/fig-prefetch-accuracy.png" alt="Prefetching accuracy" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';" />
                <div class="placeholder" style="display:none;" data-i18n="common.imgUnavailable">Image unavailable.</div>
              </div>
              <figcaption>
                <strong data-i18n="results.q6.cap.title">Prefetching Accuracy</strong>
                <span data-i18n="results.q6.cap.desc">Accuracy impact of prefetching policies.</span>
              </figcaption>
            </figure>
          </div>
        </div>
      </section>

      <section id="citation" aria-label="Citation">
        <div class="section-head">
          <div>
            <h2 data-i18n="citation.title">Citation</h2>
            <p data-i18n="citation.subtitle">Please cite our work if you find it useful.</p>
          </div>
        </div>
        <div class="divider"></div>

        <div style="margin-top: 16px;">
          <div class="row">
            <strong>BibTeX</strong>
            <button class="btn" id="copyBib" type="button">
              <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M9 9h10v10H9z" stroke="currentColor" stroke-width="1.7"/>
                <path d="M5 5h10v10" stroke="currentColor" stroke-width="1.7" opacity=".9"/>
              </svg>
              <span id="copyBibLabel" data-i18n="actions.copy">Copy</span>
            </button>
          </div>
          <pre class="bib" id="bibtex">@article{zhu2025enabling,
  title={Enabling MoE on the Edge via Importance-Driven Expert Scheduling},
  author={Zhu, Guoying and Li, Meng and Dai, Haipeng and Liu, Xuechen and Wang, Weijun and Li, Keran and Xiao, Jun and Chen, Ligeng and Wang, Wei},
  journal={arXiv preprint arXiv:2508.18983},
  year={2025}
}</pre>
        </div>
      </section>

      <footer>
        <div class="foot">
          <div>
            <strong>MoE-Edge · SMoE</strong><br/>
            <span data-i18n="footer.blurb">Project page for SMoE: Importance-Driven Expert Scheduling on memory-constrained edge hardware.</span>
          </div>
          <div>
            <span data-i18n="footer.paper">Paper:</span>
            <a href="https://arxiv.org/abs/2508.18983" target="_blank" rel="noreferrer" style="color: rgba(17,24,39,.90); text-decoration: underline; text-decoration-color: rgba(17,24,39,.25);">
              arXiv:2508.18983
            </a>
          </div>
        </div>
      </footer>
    </div>
  </main>

  <script>
    // Smooth scroll
    document.querySelectorAll('a[href^="#"]').forEach(a => {
      a.addEventListener('click', (e) => {
        const id = a.getAttribute('href');
        if (!id || id === '#') return;
        const el = document.querySelector(id);
        if (!el) return;
        e.preventDefault();
        el.scrollIntoView({ behavior: 'smooth', block: 'start' });
        history.replaceState(null, '', id);
      });
    });

    // Active nav highlighting
    const navLinks = Array.from(document.querySelectorAll('.nav a'));
    const sections = navLinks
      .map(a => document.querySelector(a.getAttribute('href')))
      .filter(Boolean);

    const io = new IntersectionObserver((entries) => {
      const visible = entries
        .filter(e => e.isIntersecting)
        .sort((a,b) => b.intersectionRatio - a.intersectionRatio)[0];
      if (!visible) return;
      navLinks.forEach(a => a.classList.toggle('active', a.getAttribute('href') === '#' + visible.target.id));
    }, { rootMargin: '-25% 0px -70% 0px', threshold: [0.08, 0.15, 0.25] });

    sections.forEach(s => io.observe(s));

    // i18n (EN / 简体中文)
    const zh = {
      // nav / cta
      "nav.ascend": "昇腾910B",
      "nav.motivation": "动机",
      "nav.method": "方法",
      "nav.results": "结果",
      "nav.citation": "引用",
      "cta.pdf": "论文PDF",
      "cta.code": "代码",

      // ascend
      "ascend.badge": "昇腾支持",
      "ascend.title": "华为昇腾 910B 支持",
      "ascend.desc": "SMoE 可通过 <strong>CANN</strong> 部署在昇腾平台上。核心思路不变：将热点专家常驻设备内存，最大化复用（命中 + 软命中），并将计算与异步传输重叠以降低端到端时延。",
      "ascend.btnCode": "SMoE 代码（GitHub）",
      "ascend.btnMethod": "查看方法",
      "ascend.b1.title": "昇腾 910B（达芬奇）",
      "ascend.b1.desc": "面向大规模训练与推理的高吞吐 AI 加速器。",
      "ascend.b2.title": "HBM 容量与带宽",
      "ascend.b2.desc": "更大的 HBM 常驻缓存意味着更少的主机↔设备传输。",
      "ascend.b3.title": "CANN 运行时",
      "ascend.b3.desc": "基于 Stream 的调度 + 异步 memcpy，实现算拷重叠。",

      // hero
      "hero.badge": "边缘 MoE 推理 · 替换 + 调度 · CPU–GPU 流水线",
      "hero.title": "Enabling MoE on the Edge<br/>via Importance-Driven Expert Scheduling",
      "hero.subtitle": "在显存受限的边缘设备上，我们采用<strong>重要性驱动</strong>策略优先保障关键专家，并将低重要性激活专家<strong>替换</strong>为 GPU 内存中功能相近的已缓存专家，从而减少 PCIe 传输与 CPU 计算开销，显著降低解码延迟（TPOT）。",
      "hero.keyClaimsTitle": "关键指标",
      "hero.keyClaimsSubtitle": "项目亮点概览",
      "hero.metric1.k": "解码延迟",
      "hero.metric1.hint": "相对 SOTA 基线",
      "hero.metric2.k": "缓存命中率",
      "hero.metric2.hint": "几乎无损精度",

      // motivation
      "motivation.title": "动机",
      "motivation.subtitle": "为什么边缘 MoE 难：PCIe 传输主导时延。",
      "motivation.h3": "“显存墙”瓶颈",
      "motivation.p": "在边缘设备（如 NVIDIA A6000）上，经 PCIe 从 CPU 内存拉取专家的代价往往远高于 GPU 计算本身。如图所示，<strong>PCIe 传输时间（橙色）</strong>经常显著超过<strong>GPU 计算时间（蓝色）</strong>。要实现低 TPOT 的实时推理，关键在于尽量减少这类昂贵传输。",
      "motivation.cap.title": "瓶颈来源",
      "motivation.cap.desc": "PCIe 传输 vs. GPU 计算时间。",

      // method
      "method.title": "方法",
      "method.subtitle": "SMoE：重要性驱动的替换式专家调度。",
      "method.card1.tag": "1. 路由",
      "method.card1.title": "专家缓存路由器",
      "method.card1.desc": "基于 gating 分数区分关键/非关键专家，优先让关键专家常驻显存。",
      "method.card2.tag": "2. 策略",
      "method.card2.title": "基于相似性的替换",
      "method.card2.desc": "非关键专家不在设备侧时不再阻塞加载，用功能相近的缓存专家替换继续推理。",
      "method.card3.tag": "3. 系统",
      "method.card3.title": "CPU–GPU 流水线",
      "method.card3.desc": "用异步预取与计算重叠隐藏加载开销，稳定低 TPOT。",
      "method.fig1.title": "框架总览",
      "method.fig1.desc": "替换式调度：低分替换，高分预取。",
      "method.pipeline.title": "执行流水线",
      "method.pipeline.desc": "GPU 计算、CPU 侧处理与 PCIe 传输交叠执行。",

      // results
      "results.title": "关键发现",
      "results.subtitle": "在不牺牲精度的前提下，时延能降到什么程度？",
      "results.q1.title": "01. 替换是否显著降低解码时延？",
      "results.q1.p": "<strong>是的，接近减半。</strong> 通过替换非关键专家，SMoE 大幅减少 PCIe 传输；相对主流 offloading 基线，TPOT 最高可降低 <strong>48%</strong>。",
      "results.q1.cap.title": "解码延迟（TPOT）",
      "results.q1.cap.desc": "在 5 类 workload 上稳定优于多种基线方案。",
      "results.q2.title": "02. 加速的根本原因是什么？",
      "results.q2.p": "<strong>PCIe 开销被显著削减。</strong> TPOT 与 PCIe 时间强相关；通过替换维持较高命中率（>60%），让多数专家计算留在设备侧完成。",
      "results.q2.s1.h": "PCIe 时间几乎直接决定 TPOT",
      "results.q2.s1.p": "边缘场景下，offloading 主要受 PCIe 传输影响。该图展示了 PCIe 时间与 TPOT 的强相关性，解释了为何“减少传输”会立刻带来提速。",
      "results.q2.s1.cap.title": "PCIe vs. TPOT",
      "results.q2.s1.cap.desc": "PCIe 越低，TPOT 越低。",
      "results.q2.s2.h": "高命中率让推理尽量留在设备侧",
      "results.q2.s2.p": "替换将大量低重要性激活变成“软命中”，提升复用率，使 GPU/Ascend 能在不等待传输的情况下执行更多专家。",
      "results.q2.s2.cap.title": "缓存命中率",
      "results.q2.s2.cap.desc": "不同设置下保持较高复用率。",
      "results.q2.s3.h": "替换减少必须加载的专家数量",
      "results.q2.s3.p": "关键在于选择性：真正影响质量的是少数高分专家；大量低分激活可被设备侧相近专家替换，从而减少加载与预取压力。",
      "results.q2.s3.cap.title": "加载需求下降",
      "results.q2.s3.cap.desc": "需要从 CPU 拉取的专家更少。",
      "results.q3.title": "03. 哪个组件贡献最大？",
      "results.q3.p": "<strong>替换是核心驱动。</strong> 消融结果显示：流水线和预取有帮助，但替换机制带来的时延降低最显著。",
      "results.q3.cap.title": "组件消融",
      "results.q3.cap.desc": "不同组件对时延收益的贡献分解。",
      "results.q4.title": "04. 低 batch 下，CPU 计算是可行兜底吗？",
      "results.q4.p": "<strong>通常不是。</strong> 交互式低 batch 场景里，CPU 计算和内存搬运开销往往更大，系统容易被 CPU/传输拖慢，因此目标是尽量避免 CPU 执行专家。",
      "results.q4.s1.h": "低 batch 下 GPU 与 CPU 的差距",
      "results.q4.s1.p": "该对比展示了 low-batch 场景下 GPU 与 CPU 的性能差异。SMoE 的目标是通过提升设备侧“命中”（硬命中+软命中）尽量避免 CPU 执行专家。",
      "results.q4.cap.title": "GPU vs. CPU（低 batch）",
      "results.q4.cap.desc": "CPU 往往不是交互式推理的理想兜底方案。",
      "results.q5.title": "05. 除了解码，Prefill 也能受益吗？",
      "results.q5.p": "<strong>可以。</strong> 虽然 TPOT 是交互式解码核心指标，但 prefill 也影响端到端时延；在同样的显存/卸载约束下，prefill 时间也有一致改善。",
      "results.q5.s1.h": "Prefill 时间降低",
      "results.q5.s1.p": "Prefill 更并行，但在显存受限时依然会被专家搬运与 cache miss 影响。SMoE 通过降低加载压力，缩短平均 prefill 时间。",
      "results.q5.cap.title": "Prefill 时间",
      "results.q5.cap.desc": "不同方案的平均 prefill 时间对比。",
      "results.q6.title": "06. 预取会影响精度吗？",
      "results.q6.p": "<strong>可控。</strong> 通过评估不同预取策略对质量的影响，并结合重要性选择与替换，系统目标是在加速的同时保持几乎无损精度。",
      "results.q6.s1.h": "预取下的质量表现",
      "results.q6.s1.p": "预取能减少等待，但若路由变化可能加载“错误”的专家。对预取精度进行评估，有助于验证策略与真实专家使用保持一致。",
      "results.q6.cap.title": "预取精度",
      "results.q6.cap.desc": "不同预取策略对质量的影响。",

      // citation / footer / actions
      "citation.title": "引用",
      "citation.subtitle": "如果本工作对你有帮助，欢迎引用。",
      "actions.copy": "复制",
      "actions.copied": "已复制",
      "footer.blurb": "SMoE 项目主页：面向显存受限边缘硬件的重要性驱动专家调度。",
      "footer.paper": "论文：",

      // common
      "common.imgUnavailable": "图片未加载。"
    };

    const i18nEls = Array.from(document.querySelectorAll('[data-i18n]'));
    i18nEls.forEach(el => {
      if (!el.dataset.i18nEn) el.dataset.i18nEn = el.innerHTML;
    });

    let currentLang = 'en';
    function setLang(lang){
      currentLang = lang === 'zh' ? 'zh' : 'en';
      document.documentElement.lang = currentLang === 'zh' ? 'zh-CN' : 'en';

      i18nEls.forEach(el => {
        const key = el.dataset.i18n;
        if (currentLang === 'zh') {
          if (zh[key]) el.innerHTML = zh[key];
        } else {
          el.innerHTML = el.dataset.i18nEn || el.innerHTML;
        }
      });

      const toggle = document.getElementById('langToggle');
      if (toggle) toggle.textContent = currentLang === 'zh' ? 'EN' : '中文';

      localStorage.setItem('lang', currentLang);
    }

    const saved = localStorage.getItem('lang');
    const preferZh = (navigator.language || '').toLowerCase().startsWith('zh');
    setLang(saved || (preferZh ? 'zh' : 'en'));

    const toggle = document.getElementById('langToggle');
    if (toggle) toggle.addEventListener('click', () => setLang(currentLang === 'zh' ? 'en' : 'zh'));

    // Copy BibTeX (keeps icon)
    const btn = document.getElementById('copyBib');
    const bib = document.getElementById('bibtex');
    const copyLabel = document.getElementById('copyBibLabel');
    if (btn && bib && copyLabel) {
      btn.addEventListener('click', async () => {
        const text = bib.textContent || '';
        const copiedText = currentLang === 'zh' ? (zh['actions.copied'] || '已复制') : 'Copied';
        try{
          await navigator.clipboard.writeText(text);
          copyLabel.textContent = copiedText;
          setTimeout(() => setLang(currentLang), 1100);
        }catch(e){
          const ta = document.createElement('textarea');
          ta.value = text;
          document.body.appendChild(ta);
          ta.select();
          document.execCommand('copy');
          ta.remove();
          copyLabel.textContent = copiedText;
          setTimeout(() => setLang(currentLang), 1100);
        }
      });
    }
  </script>
</body>
</html>


